var loadComments;
$document.ready(function(){function r(a){a.data("page",0);a.data("last-id",null);a.empty();n(a)}function n(a,c){var b=a.data("order-by"),d=a.data("profanity"),g=a.data("page"),f=a.data("last-id"),e=a.closest(".contentWrapper"),h=e.data("id"),e=e.data("type"),k=a.closest(l).find(".comments-loader-bottom");"number"!=typeof c&&(c=10);k.show();$.ajax("/comment-new/",{method:"GET",data:{action:"get",content_id:h,content_type:e,page:g,last_id:f,order_by:b,profanity:d,limit:c}}).done(function(c){a.data("page",g+=
1);a.append(c);k.hide()})}function s(a){if(!1===isLoggedIn)return $(".open-login").click(),!1;var c=a.closest(".comment"),b=a.closest(l),d=b.find(m),g=a.find(".comment-submission-textarea").val().trim(),f=d.closest(".contentWrapper"),e=f.data("id"),h=f.data("type"),k=a.find(".type").val(),f=a.find(".parent-id").val(),p=a.parent().find(".ajax-loader"),e={content_id:e,content_type:h,content:g};"edit"===k?e.comment_id=f:"reply"===k?e.parent_id=f:p=b.find(".comments-loader-top");p.show();if(""==g)return alert("Content must be included"),
!1;q=!0;$.ajax("/comment-new/?action=submit",{method:"POST",data:e}).done(function(b){"edit"===k&&a.find(".type").val("reply");q=!1;p.hide();if(!1==b.error)return"new"===b.save_type?0<b.parent_id?(c.find(".comment-children").first().append(b.comment),a.parent().hide(),c.find(".reply-to-comment").text("reply").removeClass("close-form")):d.prepend(b.comment):(c.find(".comment-content").first().text(b.comment.comment_raw),a.parent().hide(),c.find(".edit-comment").first().text("edit").removeClass("close-form")),
!0;if(1==b.error_code&&"new"===b.save_type)return $(".open-login").click(),!1;alert(b.error_message);return!1})}function t(a){var c=a.find(".count"),b=parseInt(c.text()),d=a.hasClass("up-vote"),g=a.closest(".comment"),f=g.find(".total-votes").first(),e=parseInt(f.text()),g=g.data("id"),h=a.closest(l).find(m).closest(".contentWrapper"),k=h.data("id"),h=h.data("type");$.ajax("/comment-new/?action=add_vote",{method:"POST",data:{content_id:k,content_type:h,vote_content_id:g,vote:d?1:-1}}).done(function(d){if(!1!=
d.error)return alert(d.error_message),!1;a.addClass("voted");b+=1;c.text(b);e+=parseInt(d.vote);f.removeClass("positive negative");0<e?(e="+"+e,f.addClass("positive")):0>e&&f.addClass("negative");f.text(e)})}var l=".comments-wrap",m=".comments-list",q=!1;$document.on("click",".comment-option",function(a){var c=$(a.target),b=c.data("option"),d=c.closest(l),g=d.find(m),d=d.find(".comment-option"),f=g.data("order-by");b!==f&&(d.removeClass("active"),c.addClass("active"),g.data("order-by",b),r(g));a.preventDefault()});
$document.on("click",".profanity-option",function(a){var c=$(a.target),b=c.closest(l).find(m),d=b.data("profanity");d?c.text("Show Profanity"):c.text("Hide Profanity");c.toggleClass("show hide");b.data("profanity",!d);r(b);a.preventDefault()});$document.on("click",".load-more-comments",function(a){var c=$(a.target).closest(l).find(m);n(c);a.preventDefault()});window.loadComments=n;$document.on("click",".comment-mark-action",function(a){var c=$(a.target),b=c.closest(".comment"),d=b.closest(".contentWrapper"),
g=d.data("id"),d=d.data("type"),f="Are you sure you want to delete this comment?",e="/comment-new/?action=delete";c.hasClass("comment-mark-spam")&&(f="Are you sure you want to mark this comment as spam?",e="/comment-new/?action=mas");a.preventDefault();confirm(f)&&(b.hide(),$.ajax(e,{method:"GET",data:{content_id:g,content_type:d,id:b.data("id")}}).done(function(a){if(!1==a.error)return b.remove(),!0;b.show();alert(a.error_message)}))});$document.on("click",".comment-delete-user",function(a){var c=
$(a.target),b=c.closest(".comment").find(".comment-message");a.preventDefault();confirm("Are you sure you want to delete this user?")&&(b.text("Deleting user...").show(),$.ajax("/users/ban/",{method:"GET",data:{user_id:c.data("user-id")}}).done(function(a){a=JSON.parse(a);if(!1==a.error)return window.location.reload(!0),!0;b.hide();alert(a.error_message)}))});$document.on("click",".children-action",function(a){var c=$(a.target),b=c.closest(".comment").find(".comment-children").find(".comment");a.preventDefault();
c.hasClass("hide-all-children")?b.hide():b.show()});$document.on("click",".meta-form-action",function(a){var c=$(a.target),b=c.closest(".comment"),d=b.find(".reply-to-comment").first(),g=b.find(".edit-comment").first(),f=b.find(".comment-submission").first(),e=f.find(".type"),h=f.find(".comment-submission-textarea");a.preventDefault();c.hasClass("edit-comment")?(e.val("edit"),h.val(b.find(".comment-content").first().text().trim())):(e.val("reply"),h.val(""));c.hasClass("close-form")?(c.removeClass("close-form").text(c.data("text")),
f.hide()):(d.removeClass("close-form").text(d.data("text")),g.removeClass("close-form").text(g.data("text")),c.addClass("close-form").text("Close"),f.show())});$document.on("click",".cancel-comment",function(a){var c=$(a.target),b=c.closest(".comment"),d=b.find(".reply-to-comment").first(),b=b.find(".edit-comment").first(),c=c.closest(".comment-submission");a.preventDefault();d.removeClass("close-form").text(d.data("text"));b.removeClass("close-form").text(b.data("text"));c.hide()});$document.on("submit",
".comment-submission-form",function(a){var c=$(a.target);a.preventDefault();q||s(c);return!1});$document.on("click",".vote",function(a){if(!1===isLoggedIn)return $(".open-login").click(),!1;a.preventDefault();a=$(a.currentTarget);if(a.hasClass("voted"))return alert("You have already voted on this comment"),!1;t(a)})});

$document.ready(function(){$document.on("click",".btn-more-share",function(a){var b=$(a.currentTarget),c=b.closest("ul");a.preventDefault();c.addClass("expanded");c.find(".hidden-social").removeClass("hidden-social");b.parent().addClass("hidden")})});

function activityTabs(){var a=$(".activity-tabs");768>$(window).width()?(a.css("top","-"+($(".activity-tabs").outerHeight()-70)+"px").addClass("close-tabs"),a.css("left","0px"),$(".btn-activity").click(function(b){b.preventDefault();a.hasClass("close-tabs")?a.stop().animate({top:"60px"},300).removeClass("close-tabs"):a.stop().animate({top:"-"+($(".activity-tabs").outerHeight()-70)+"px"},300).addClass("close-tabs")}),$(".close-activity-tabs").click(function(b){b.preventDefault();b.preventDefault();
a.stop().animate({top:"-"+($(".activity-tabs").outerHeight()-70)+"px"},300).addClass("close-tabs")})):(a.css("left","-"+$(".activity-tabs").outerWidth()+"px").addClass("close-tabs"),a.css("top","60px"),$(".btn-activity").click(function(b){b.preventDefault();a.hasClass("close-tabs")?a.stop().animate({left:"0px"},300).removeClass("close-tabs"):a.stop().animate({left:"-"+$(".activity-tabs").outerWidth()+"px"},300).addClass("close-tabs")}),$(".close-activity-tabs").click(function(b){b.preventDefault();
b.preventDefault();a.stop().animate({left:"-"+$(".activity-tabs").outerWidth()+"px"},300).addClass("close-tabs")}))}activityTabs();$(window).resize(function(){activityTabs()});

function parallax(){var f=[],k=$(window),g=$("nav.navbar").height(),e=k.scrollTop(),d=function(){e=k.scrollTop();for(var a=0;a<f.length;a++){var b=f[a],c=b.offset().top,h=b.height(),h=c+h,d=0;e+g>c&&e+g<h&&(d=(e+g-c)/2);b.css("background-position-y",d+"px")}};$("div.parallax > img").each(function(){var a=$(this),b=a.parent(),c=a.attr("src");b.css("background-image","url("+$("<div></div>").text(c).html()+")");a.css("visibility","hidden");f.push(b);d()});$(window).on("scroll.parallax",d)}parallax();

$document.ready(function(){var b=$("#footer");$("#goDownFooter").click(function(a){b.toggleClass("active");a.preventDefault()});$("#closeFooter").click(function(a){b.toggleClass("active");a.preventDefault()})});

var ResponsiveContent=function(){function C(){var b=(new Date).getTime()/4%310;J.css("stroke-dashoffset",b+"px");requestAnimationFrame(C)}function K(){!s&&document.body.clientHeight-window.scrollY-500<=window.innerHeight&&q<D&&(s=!0,$.ajax("/get-content/",{method:"GET",data:{id:readingListUrls[q].id,type:readingListUrls[q].contentType,pages:[1]}}).done(function(b){b=$(b);L.append(b);b=b.closest(".contentWrapper");g=$(".entryWrapper");h=$(".entry");k=$(".page-break");parallax();loadComments(b.find(".comments-list").last(),
3);b.find(".lazy, img").lazyload({load:function(a,b,c){}});t("getShareCounts",[b.data("id"),b.data("type"),b.data("url")]);q++;q===D&&(b.find(".btn-scroll-down").remove(),M.hide());s=!1}))}function t(b,a){"function"===typeof v[b]&&(Array.isArray(a)||(a=[]),v[b].apply(null,a))}function w(){var b=new Image;b.src="/tracking/beacon/?content_type="+f+"&content_id="+e+"&rand="+(new Date).getTime();b=new Image;b.src="/tracking/pixel/?content_type="+f+"&content_id="+e+"&rand="+(new Date).getTime()}function N(){!u&&
!l&&window.scrollY>=x?(l=!0,E.fadeOut(200,function(){y.fadeIn(200,function(){l=!1;u=!0})})):u&&!l&&window.scrollY<x&&(l=!0,y.fadeOut(200,function(){E.fadeIn(200,function(){u=l=!1})}))}function m(b){for(var a=b.offsetLeft,r=b.offsetTop;b=b.offsetParent;)a+=b.offsetLeft,r+=b.offsetTop;return{left:a,top:r}}function z(b){var a=window.scrollY,r=a+window.innerHeight,c=m(b).top-O;b=c+b.offsetHeight;return r>=c&&a<=b}var O=70,F=1,q=1,D=4,A=!1,g=$(".entryWrapper"),h=$(".entry"),k=$(".page-break"),c=$(g[0]),
G=h[0],H=k[0],e=c.data("id"),f=c.data("type");c.data("can-spike");var v={},n=m(c[0]).top,p=c.height(),B=n+p,L=$("#contentsWrapper"),P=$("title"),s=!1;c.data("url");var M=$("#infiniteLoader"),J=$("#outline"),y=$("#navbarTitle"),I=y.find("a"),E=$("#navbarNavItems"),u=!1,l=!1,Q=$("#metaPageType"),R=$("#metaContentID"),S=$("#metaCategory"),T=$("#metaSubPageType"),U=$("#metaStudioID"),V=$("#metaPublishDate"),W=$("#metaDescription"),X=$("#ogTitle"),Y=$("#ogType"),Z=$("#ogUrl"),aa=$("#ogImage"),ba=$("#ogDescription"),
x=0;return{init:function(b){!1===b&&(s=!0);w();C();loadComments($(".comments-list").last(),3);t("getShareCounts",[e,f]);t("showShareCounts",[e]);n=m(c[0]).top;p=c.height();B=n+p;$window.on("scroll",function(){"desktop"===CKDFP.getCurrentViewPort()&&N();x=window.scrollY;if(!A){for(var a=null,b=0;b<g.length;b++){var d=g[b];if(null===a&&z(d)){a=$(d);break}}window.scrollY<m(g[0]).top&&(a=$(g[0]));if(a&&a[0].id!==c[0].id){A=!0;b=e;e=a.data("id");c=a;if(d=readingList[a.data("id")])F=d.num;f=c.data("type");
n=c.offset().top-60;p=c.height();B=n+p;t("updateSidebar",[a]);b!==e&&(a=readingList[a.data("id")],P.html(a.title),I.html(a.title),I.attr("href",a.url),window.history.pushState({},c.find("h1").text(),a.url),Q.attr("content",a.pageType),R.attr("content",a.id),S.attr("content",a.categoryName),T.attr("content",a.pageType+"_p1"),U.attr("content",a.id),V.attr("content",a.date),W.attr("content",a.description),X.attr("content",a.title),Y.attr("content",a.contentType),Z.attr("content",a.url),aa.attr("content",
a.image),ba.attr("content",a.description),console.log("[SIMON]",window.location.href),ResponsiveSimpleReach.runReachCollect(f,e));A=!1}}if("mobile"===CKDFP.getCurrentViewPort()&&"photoplasty"!=f&&"photoshop"!=f&&"blog"!=f){a=null;for(b=0;b<h.length;b++)if(d=h[b],null===a&&z(d)){a=d;break}window.scrollY<m(h[0]).top&&(a=h[0]);a&&a.id!==G.id&&(G=a,w(),tracker.fireAllPixels(),CrackedJS.nativePixels(),CKDFP.refreshAsyncSlot("320x50_btf"))}else{a=null;for(b=0;b<k.length;b++)if(d=k[b],null===a&&z(d)){a=
d;break}window.scrollY<m(k[0]).top&&(a=k[0]);a&&a.id!==H.id&&(H=a,w(),tracker.fireAllPixels(),CrackedJS.nativePixels(),"mobile"===CKDFP.getCurrentViewPort()&&CKDFP.refreshAsyncSlot("320x50_btf"))}K()})},setUpdateModules:function(b,a){v[b]=a},getContentItem:function(){return F},getContentID:function(){return e},getCurrentContent:function(){return c},getCurrentContentBottom:function(){return B},getCurrentContentTop:function(){return n},getCurrentContentHeight:function(){return p}}}();

var ResponsiveSidebar=function(){function l(a){a=q[a?a:ResponsiveContent.getContentID()];var f=ResponsiveContent.getCurrentContent().closest(".contentWrapper");if("undefined"===typeof a||"object"!==typeof a)a={aggregates:{social_actions:"-"},facebook:{total_actions:"-"},twitter:{total_actions:"-"},googleplus:{total_actions:"-"},pinterest:{total_actions:"-"},stumbleupon:{total_actions:"-"},reddit:{total_actions:"-"},comments_count:"-",views:"-"};a.views&&f.find(".view-counts").html(a.views+" views");
a.aggregates&&f.find(".social-info-info-one").html(a.aggregates.social_actions);a.facebook&&s.html(a.facebook.total_actions);a.twitter&&t.html(a.twitter.total_actions);a.googleplus&&u.html(a.googleplus.total_actions);a.pinterest&&v.html(a.pinterest.total_actions);a.stumbleupon&&w.html(a.stumbleupon.total_actions);a.reddit&&x.html(a.reddit.total_actions);r&&r.html(a.comments_count);m&&m.attr("href","#"+f.find(".comments-wrap")[0].id)}var n=$(".sidebar"),p=n.offset().top,h=n,b=$(".sidebar-inner"),d=
h.offset().top-70,g=ResponsiveContent.getCurrentContentBottom()-100-b.height(),y=$(".sidebar-module"),z=$("#viralModuleWrap"),A=$("#flashbackModuleWrap"),B=$("#linkstormsModuleWrap"),e=$(".persistent-share"),c=$(".persistent-share-inner"),k=ResponsiveContent.getCurrentContentBottom()-100-c.height(),q={},s=e.find(".facebook-count"),t=e.find(".twitter-count"),u=e.find(".google-plus-count"),v=e.find(".pinterest-count"),w=e.find(".stumbleupon-count"),x=e.find(".reddit-count"),m=e.find(".comments-btn"),
r=m.find(".comments-count"),C={facebook:"https://www.facebook.com/sharer/sharer.php?u={{content.url_domain}}",twitter:"https://twitter.com/share?url={{content.url_domain}}&text={{content.title}}",googlePlus:"https://plus.google.com/share?url={{content.url_domain}}",stumbleupon:"http://www.stumbleupon.com/submit?url={{content.url_domain}}&title={{content.title}}",pinterest:"http://pinterest.com/pin/create/button/?url={{content.url_domain}}&title={{content.title}}",reddit:"http://www.reddit.com/submit?url={{content.url_domain}}",
whatsapp:"whatsapp://send?text={{content.title}} | {{content.url_domain}}?utm_source=whatsapp&utm_medium=whatsapp&utm_campaign=whatsapp"};ResponsiveContent.setUpdateModules("updateSidebar",function(a){h=a.find(".sidebar");d=h.offset().top;p=n.offset().top;a=d-70;var f=ResponsiveContent.getCurrentContentBottom()-100-b.height();if(a!==d&&f!==g){"desktop"==CKDFP.getCurrentViewPort()&&CKDFP.refreshAsyncSlot("300x250_300x600_atf");b.hide();y.addClass("hide");switch(Math.floor(3*Math.random()+1)){case 1:z.removeClass("hide");
break;case 2:A.removeClass("hide");break;default:B.removeClass("hide")}d=a;g=f;b.fadeIn(300);c.hide();c[0].style.marginTop=0;k=ResponsiveContent.getCurrentContentBottom()-100-c.height();c.fadeIn(300);l()}});ResponsiveContent.setUpdateModules("getShareCounts",function(a,f,b){$.getJSON("/feed/social-counts/?content_type="+f+"&content_id="+a+"&url="+encodeURIComponent("http://www.cracked.com"+(b?b:window.location.pathname)),function(b){b.counts&&(e.data("counts"+a,"loaded"),q[a]=b.counts,ResponsiveContent.getContentID()===
a&&l(a))})});ResponsiveContent.setUpdateModules("showShareCounts",l);return{init:function(){d=h.offset().top-70;g=ResponsiveContent.getCurrentContentBottom()-100-b.height();k=ResponsiveContent.getCurrentContentBottom()-100-c.height();$window.on("scroll",function(){"desktop"===CKDFP.getCurrentViewPort()&&(0!=b.size()&&(d=ResponsiveSidebar.getCurrentSidebarTop()-70,window.scrollY>=d&&window.scrollY<g?(b[0].style.marginTop=0,b.addClass("fixed")):window.scrollY<d?(b[0].style.marginTop=0,b.removeClass("fixed")):
window.scrollY>g&&(b[0].style.marginTop=g-p+70+"px",b.removeClass("fixed"))),window.scrollY>=d&&window.scrollY<k?(c[0].style.marginTop=0,c.addClass("fixed")):window.scrollY<d?(c[0].style.marginTop=0,c.removeClass("fixed")):window.scrollY>k&&(c[0].style.marginTop=k-p+70+"px",c.removeClass("fixed")))});$document.on("click",".share-btn",function(a){var b=$(a.currentTarget),c=C[b.data("type")],c=b.hasClass("share-bar-btn")?b.attr("href"):c.replace(/{{content.url_domain}}/,window.location.href).replace(/{{content.title}}/,
$("title").html());window.open(c,"Share this!","width=600, height=400");a.preventDefault()});$document.on("click",".btn-more-persistant",function(a){var b=$(a.currentTarget);a.preventDefault();e.find(".hidden-box").removeClass("hidden-box");b.parent().addClass("hidden")})},getCurrentSidebarTop:function(){return h.offset().top}}}();

$document.ready(function(){ResponsiveContent.init();ResponsiveSidebar.init();CKDFP.initDelayedSyncAd()});
